<div
  class="grid gap-4"
  [ngClass]="{ 'grid-cols-1': uploadedFilesPosition === 'bottom', 'grid-cols-2': uploadedFilesPosition === 'right' }"
>
  <div class="card">
    <div class="">
      <h3 class="text-neutral-700">{{ title || 'Upload' }}</h3>
      @if (informationText) {
        <span class="material-symbols-outlined" matTooltip="{{ informationText }}"> info </span>
      }
    </div>
    <form [formGroup]="formGroup">
      @if (selectOptions && selectOptions.length > 0) {
        <mat-form-field appearance="outline" class="w-full">
          <mat-label class="w-full">Document Type</mat-label>
          <mat-select formControlName="documentType" placeholder="Select Document Type" class="w-full !border-none">
            <mat-option *ngFor="let option of selectOptions" [value]="option.value">
              {{ option.key }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      }

      <div
        class="flex w-full items-center justify-center"
        [ngClass]="{
          'cursor-pointer': formGroup.get('documentType')?.value || showDescriptionField,
          'bg-gray-50 hover:bg-gray-100': formGroup.get('documentType')?.value || showDescriptionField,
        }"
      >
        <label
          for="dropzone-file"
          class="flex h-64 w-full flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300"
          (drop)="onDrop($event, formGroup.get('documentType')?.value)"
          (dragover)="onDragOver($event)"
          [matTooltip]="!formGroup.get('documentType')?.value && selectOptions ? 'Select a Document Type first.' : ''"
        >
          <div class="flex flex-col items-center justify-center pb-6 pt-5" *ngIf="!formGroup.value.file">
            <span class="material-symbols-outlined text-4xl text-gray-500"> cloud_upload </span>
            <p class="mb-2 text-sm text-gray-500">
              <span class="font-semibold">Click to upload</span>
            </p>
            <p class="text-xs text-gray-500">PNG, JPG, PDF</p>
          </div>
          <div class="flex flex-col items-center justify-center pb-6 pt-5" *ngIf="formGroup.value.file">
            <span class="material-symbols-outlined text-4xl text-green-500"> check_circle</span>
            <span class="mb-2 text-sm font-semibold text-gray-500">{{ formGroup.value.file.name }}</span>
          </div>
          <input
            id="dropzone-file"
            type="file"
            [disabled]="!formGroup.get('documentType')?.value && selectOptions"
            class="hidden"
            (change)="onFileSelected($event)"
          />
        </label>
      </div>

      @if (showDescriptionField) {
        <mat-form-field class="mt-4 w-full" appearance="outline">
          <mat-label>Description</mat-label>
          <input matInput formControlName="description" placeholder="Fairtrade Certificate" />
        </mat-form-field>
      }

      <div class="flex items-center justify-center">
        <button
          mat-flat-button
          class="mt-4 text-center"
          [disabled]="!formGroup.valid"
          (click)="submitDocument()"
          [matTooltip]="buttonTooltip"
        >
          {{ buttonText }}
        </button>
      </div>
    </form>
  </div>

  <div class="card" *ngIf="showUploadedFiles">
    <div class="flex border-b-2 p-2">
      @if (selectOptions) {
        <span class="material-symbols-outlined">{{
          lengthOfUploadedFiles() === selectOptions.length ? 'check_circle' : 'pending'
        }}</span>
      }
      <div class="ml-2" [ngClass]="{ 'col-span-2': !selectOptions }">
        <span class="text-neutral-700">Document:</span>
      </div>
    </div>
    @if (selectOptions && selectOptions.length > 0) {
      @for (option of selectOptions; track $index) {
        <div class="grid grid-cols-3 border-b-2 p-2">
          <div class="col-span-2 flex">
            <span class="material-symbols-outlined border-gray-200" [ngClass]="{ 'text-green-600': option.file }">
              {{ option.file ? 'check_circle' : 'pending' }}
            </span>
            <div class="ml-2">
              {{ option.key }}
            </div>
          </div>
          @if (option.file) {
            <button
              class="material-symbols-outlined cursor-pointer text-end hover:text-red-400"
              (click)="removeProof.emit(option)"
            >
              delete
            </button>
          } @else {
            <span class="material-symbols-outlined text-end text-gray-300">delete</span>
          }
        </div>
      }
    }
    @if (uploadedFiles && uploadedFiles.length > 0) {
      @for (uploadedFile of uploadedFiles; track $index) {
        <div class="col-span-2 flex w-full justify-between border-b border-gray-200 p-2">
          <span>
            {{ uploadedFile.documentType }}
          </span>
          <div class="flex items-center gap-4">
            {{ uploadedFile.file.name }} ({{ uploadedFile.file.size | fileSize }})
            <button
              class="material-symbols-outlined cursor-pointer hover:text-red-400"
              (click)="removeDocument.emit(uploadedFile)"
            >
              delete
            </button>
          </div>
        </div>
      }
    }
  </div>
</div>
