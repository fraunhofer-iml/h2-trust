<div class="flex cursor-pointer flex-row items-center gap-4" (click)="sheet.open()" role="none">
  <div class="bg-primary-200/60 flex items-center justify-center rounded-full p-2">
    <span class="material-symbols-outlined text-white">{{
      batch().processStep !== 'BOTTLING' ? 'clock_loader_10' : 'bubble_chart'
    }}</span>
  </div>

  <div class="flex w-full flex-col">
    <div class="mb-1 flex justify-between text-sm text-neutral-500">
      <div class="flex flex-row items-center gap-2">
        <h3 class="text-base">
          {{ batch().createdAt | date: 'mediumDate' }}, {{ batch().createdAt | date: 'shortTime' }}
          @if (batch().processStep !== 'BOTTLING') {
            - {{ batch().accountingPeriodEnd | date: 'shortTime' }}
          }
        </h3>
        <app-rfnbo-chip [isRFNBOready]="batch().rfnboReady"></app-rfnbo-chip>
      </div>

      <span>GHG-Emissions (cumulated): {{ batch().emission.amountCO2PerKgH2 }} {{ batch().unit }}</span>
    </div>
    <app-verified-chart
      [amount]="batch().amount"
      [verifiedAmount]="batch().amountVerified"
      [unit]="batch().unit"
    ></app-verified-chart>
  </div>
</div>

<app-base-sheet #sheet>
  <div class="flex flex-col gap-4">
    <div>
      <div class="flex w-full items-center justify-between">
        <div class="flex flex-row items-center gap-2">
          <h3 class="text-base">
            {{ batch().createdAt | date: 'mediumDate' }}, {{ batch().createdAt | date: 'shortTime' }}
            @if (batch().processStep !== 'BOTTLING') {
              - {{ batch().accountingPeriodEnd | date: 'shortTime' }}
            }
          </h3>
          <app-rfnbo-chip [isRFNBOready]="batch().rfnboReady"></app-rfnbo-chip>
        </div>
        <app-h2-color-chip [color]="batch().color"></app-h2-color-chip>
      </div>
      <span class="text-sm text-neutral-400"> Generation-Id: {{ batch().id }}</span>
    </div>

    <app-verified-chart
      [amount]="batch().amount"
      [verifiedAmount]="batch().amountVerified"
      [unit]="batch().unit"
    ></app-verified-chart>

    <div class="grid grid-cols-2 gap-4 rounded-lg border-[2px] border-solid border-neutral-100 bg-neutral-50 p-4">
      <span class="col-span-2 text-neutral-600">Batch Details</span>
      @if (batch().processStep !== 'BOTTLING') {
        <div class="flex flex-col text-sm">
          <span class="text-sm text-neutral-500">Created at:</span
          ><span>{{ batch().createdAt | date: 'mediumDate' }}</span>
        </div>
        <div class="flex flex-col text-sm">
          <span class="text-sm text-neutral-500">Accounting Period:</span
          ><span
            >{{ batch().createdAt | date: 'shortTime' }} - {{ batch().accountingPeriodEnd | date: 'shortTime' }}</span
          >
        </div>
      } @else {
        <div class="flex flex-col text-sm">
          <span class="text-sm text-neutral-500">Bottled at:</span
          ><span>{{ batch().createdAt | date: 'mediumDate' }}, {{ batch().createdAt | date: 'shortTime' }}</span>
        </div>
      }
      <div class="flex flex-col text-sm">
        <span class="text-sm text-neutral-500">Purity:</span><span>{{ batch().purity || '-' }} %</span>
      </div>
      <div class="flex flex-col text-sm">
        <span class="text-sm text-neutral-500">Process Step:</span
        ><span>{{ batch().processStep | prettyEnum | titlecase }}</span>
      </div>

      @if (batch().processStep !== 'BOTTLING') {
        <div class="flex flex-col text-sm">
          <span class="text-sm text-neutral-500">Producer:</span><span>{{ batch().producer }}</span>
        </div>
        <div class="flex flex-col text-sm">
          <span class="text-sm text-neutral-500">Type of Production:</span><span>{{ batch().typeOfProduction }}</span>
        </div>
      }

      <div class="flex flex-col text-sm">
        <span class="text-sm text-neutral-500">Unit-Id:</span><span>{{ batch().unitId }}</span>
      </div>
    </div>

    <div class="flex flex-col rounded-lg border-[2px] border-solid border-neutral-100 bg-neutral-50 p-4">
      <span class="text-neutral-600">Hydrogen Composition</span>
      <app-h2-composition-chart [chartData]="batch().hydrogenComposition"></app-h2-composition-chart>
    </div>
  </div>
</app-base-sheet>
